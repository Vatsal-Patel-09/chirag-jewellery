<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Ashirwaad Jewelry</title>
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha2/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="../style.css">
</head>

<body>
    <div class="home_black_version">
        <!-- Minimal header -->
        <header class="header_area header_black">
            <div class="header_middel">
                <div class="container">
                    <div class="row align-items-center justify-content-center">
                        <div class="col-auto">
                            <div class="logo" style="padding:0;">
                                <a href="../index.html"><img src="../images/logo/logo-ash.png" alt="Ashirwaad"></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Login Form -->
        <section class="auth_section">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-5 col-md-7 col-sm-10 col-12">
                        <div class="auth_card">
                            <h2>Welcome Back</h2>
                            <p class="auth_subtitle">Login to your Ashirwaad account</p>

                            <div id="login_message" class="auth_message" style="display:none;"></div>

                            <form id="login_form" autocomplete="on">
                                <div class="auth_field">
                                    <label for="login_email">Email Address</label>
                                    <div class="auth_input_wrap">
                                        <i class="ion-ios-email-outline"></i>
                                        <input type="email" id="login_email" placeholder="your@email.com" required
                                            autocomplete="email">
                                    </div>
                                </div>
                                <div class="auth_field">
                                    <label for="login_password">Password</label>
                                    <div class="auth_input_wrap">
                                        <i class="ion-locked"></i>
                                        <input type="password" id="login_password" placeholder="Enter your password"
                                            required autocomplete="current-password">
                                    </div>
                                </div>
                                <button type="submit" class="auth_btn" id="login_btn">
                                    <span class="btn_text">Login</span>
                                    <span class="btn_loader" style="display:none;">
                                        <i class="ion-load-c"></i> Logging in...
                                    </span>
                                </button>
                            </form>

                            <div class="auth_footer">
                                <p>Don't have an account? <a href="signup.html">Create Account</a></p>
                                <a href="../index.html" class="back_home">
                                    <i class="ion-arrow-left-c"></i> Back to Home
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script src="../js/github-db.js"></script>
    <script src="../js/auth.js"></script>
    <script>
        document.getElementById('login_form').addEventListener('submit', async function (e) {
            e.preventDefault();

            const btn = document.getElementById('login_btn');
            const btnText = btn.querySelector('.btn_text');
            const btnLoader = btn.querySelector('.btn_loader');
            const msgBox = document.getElementById('login_message');

            const email = document.getElementById('login_email').value;
            const password = document.getElementById('login_password').value;

            // Show loading
            btnText.style.display = 'none';
            btnLoader.style.display = 'inline';
            btn.disabled = true;
            msgBox.style.display = 'none';

            try {
                const result = await Auth.login(email, password);

                if (result.ok) {
                    msgBox.className = 'auth_message success';
                    msgBox.textContent = result.msg;
                    msgBox.style.display = 'block';
                    setTimeout(() => {
                        window.location.href = '../index.html';
                    }, 800);
                } else {
                    msgBox.className = 'auth_message error';
                    msgBox.textContent = result.msg;
                    msgBox.style.display = 'block';
                    btnText.style.display = 'inline';
                    btnLoader.style.display = 'none';
                    btn.disabled = false;
                }
            } catch (err) {
                msgBox.className = 'auth_message error';
                msgBox.textContent = 'Something went wrong. Please try again.';
                msgBox.style.display = 'block';
                btnText.style.display = 'inline';
                btnLoader.style.display = 'none';
                btn.disabled = false;
                console.error(err);
            }
        });

        // Redirect if already logged in
        if (Auth.isLoggedIn()) {
            window.location.href = '../index.html';
        }
    </script>
</body>

</html>
