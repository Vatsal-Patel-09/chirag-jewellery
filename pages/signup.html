<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - Ashirwaad Jewelry</title>
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha2/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="../style.css">
</head>

<body>
    <div class="home_black_version">
        <!-- Minimal header -->
        <header class="header_area header_black">
            <div class="header_middel">
                <div class="container">
                    <div class="row align-items-center justify-content-center">
                        <div class="col-auto">
                            <div class="logo" style="padding:0;">
                                <a href="../index.html"><img src="../images/logo/logo-ash.png" alt="Ashirwaad"></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Sign Up Form -->
        <section class="auth_section">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-5 col-md-7 col-sm-10 col-12">
                        <div class="auth_card">
                            <h2>Create Account</h2>
                            <p class="auth_subtitle">Join the Ashirwaad family</p>

                            <div id="signup_message" class="auth_message" style="display:none;"></div>

                            <form id="signup_form" autocomplete="on">
                                <div class="auth_field">
                                    <label for="signup_name">Full Name</label>
                                    <div class="auth_input_wrap">
                                        <i class="ion-person"></i>
                                        <input type="text" id="signup_name" placeholder="Enter your full name" required
                                            autocomplete="name">
                                    </div>
                                </div>
                                <div class="auth_field">
                                    <label for="signup_email">Email Address</label>
                                    <div class="auth_input_wrap">
                                        <i class="ion-ios-email-outline"></i>
                                        <input type="email" id="signup_email" placeholder="your@email.com" required
                                            autocomplete="email">
                                    </div>
                                </div>
                                <div class="auth_field">
                                    <label for="signup_phone">Phone Number</label>
                                    <div class="auth_input_wrap">
                                        <i class="ion-ios-telephone"></i>
                                        <input type="tel" id="signup_phone" placeholder="Enter your phone number"
                                            autocomplete="tel">
                                    </div>
                                </div>
                                <div class="auth_field">
                                    <label for="signup_password">Password</label>
                                    <div class="auth_input_wrap">
                                        <i class="ion-locked"></i>
                                        <input type="password" id="signup_password" placeholder="Minimum 6 characters"
                                            required minlength="6" autocomplete="new-password">
                                    </div>
                                </div>
                                <div class="auth_field">
                                    <label for="signup_confirm">Confirm Password</label>
                                    <div class="auth_input_wrap">
                                        <i class="ion-locked"></i>
                                        <input type="password" id="signup_confirm" placeholder="Re-enter your password"
                                            required minlength="6" autocomplete="new-password">
                                    </div>
                                </div>
                                <button type="submit" class="auth_btn" id="signup_btn">
                                    <span class="btn_text">Create Account</span>
                                    <span class="btn_loader" style="display:none;">
                                        <i class="ion-load-c"></i> Creating...
                                    </span>
                                </button>
                            </form>

                            <div class="auth_footer">
                                <p>Already have an account? <a href="login.html">Login</a></p>
                                <a href="../index.html" class="back_home">
                                    <i class="ion-arrow-left-c"></i> Back to Home
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script src="../js/github-db.js"></script>
    <script src="../js/auth.js"></script>
    <script>
        document.getElementById('signup_form').addEventListener('submit', async function (e) {
            e.preventDefault();

            const btn = document.getElementById('signup_btn');
            const btnText = btn.querySelector('.btn_text');
            const btnLoader = btn.querySelector('.btn_loader');
            const msgBox = document.getElementById('signup_message');

            const name = document.getElementById('signup_name').value;
            const email = document.getElementById('signup_email').value;
            const phone = document.getElementById('signup_phone').value;
            const password = document.getElementById('signup_password').value;
            const confirm = document.getElementById('signup_confirm').value;

            // Validate passwords match
            if (password !== confirm) {
                msgBox.className = 'auth_message error';
                msgBox.textContent = 'Passwords do not match.';
                msgBox.style.display = 'block';
                return;
            }

            // Show loading
            btnText.style.display = 'none';
            btnLoader.style.display = 'inline';
            btn.disabled = true;
            msgBox.style.display = 'none';

            try {
                const result = await Auth.signUp(name, email, password, phone);

                if (result.ok) {
                    msgBox.className = 'auth_message success';
                    msgBox.textContent = result.msg;
                    msgBox.style.display = 'block';
                    setTimeout(() => {
                        window.location.href = '../index.html';
                    }, 800);
                } else {
                    msgBox.className = 'auth_message error';
                    msgBox.textContent = result.msg;
                    msgBox.style.display = 'block';
                    btnText.style.display = 'inline';
                    btnLoader.style.display = 'none';
                    btn.disabled = false;
                }
            } catch (err) {
                msgBox.className = 'auth_message error';
                msgBox.textContent = 'Something went wrong. Please try again.';
                msgBox.style.display = 'block';
                btnText.style.display = 'inline';
                btnLoader.style.display = 'none';
                btn.disabled = false;
                console.error(err);
            }
        });

        // Redirect if already logged in
        if (Auth.isLoggedIn()) {
            window.location.href = '../index.html';
        }
    </script>
</body>

</html>
